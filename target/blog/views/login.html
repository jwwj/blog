<!DOCTYPE html>
<html>

<head>
<meta charset="UTF-8">
<title></title>
<script src="static/jquery/jquery-3.2.1.js"></script>
<script src="static/bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>
<script src="js/ajaxsetup.js"></script>
<link href="static/bootstrap-3.3.7-dist/css/bootstrap.min.css"
	rel="stylesheet" />

<style type="text/css">
.item {
	margin: 20px 10px 20px 10px;
}

.center {
	text-align: center;
}

.logo {
	margin-top: 40px;
	margin-bottom: 20px;
}

input {
	border-radius: 4px;
}

body {
	background: #f7fafc;
}

.input-group {
	border-radius: 0px 0px 4px 4px;
	border: 1px solid #ccc;
	border-top: 0px;
	background: white;
	margin: 0px 10px 10px 10px;
	width: 100%;
}

.nav {
	margin: 10px 10px 0px 10px;
}

.input-group .item {
	width: 94.5%;
}
</style>

</head>

<body css="login">

	<a id="myModal" data-toggle="modal" data-target=".bs-example-modal-sm"></a>

	<div class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog"
		aria-labelledby="mySmallModalLabel">
		<div class="modal-dialog modal-sm" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"
						aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
					<h4 class="modal-title">登陆失败</h4>
				</div>
				<div class="modal-body">
					<p></p>
				</div>
			</div>
		</div>
	</div>


	<div class="container">
		<div class="row">
			<div class="col-md-4 col-md-offset-4 logo center">
				<img src="img/logo.gif" width="100%" />
			</div>
		</div>
		<div class="row">
			<div class="col-md-4 col-md-offset-4 ">
				<ul class="nav nav-tabs nav-justified">
					<li role="presentation" class="active"><a href="#">登录</a></li>
					<li role="presentation" class="inactive"><a href="#">注册</a></li>
				</ul>
				<div class="input-group ">
					<form style="display: block;" class="showform" role="form">
						<div>
							<input style="border-radius: 4px;" type="text"
								class="form-control item" placeholder="手机" id="phone"
								aria-describedby="sizing-addon2"> <span
								style="padding-left: 15px;" class="help-block"></span>

						</div>

						<div>
							<input style="border-radius: 4px;" type="password" id="pwd"
								class="form-control item" placeholder="密码"
								aria-describedby="sizing-addon2"> <span
								style="padding-left: 15px;" class="help-block"></span>
						</div>
						<button type="button" class="btn btn-primary item" id="sin">登录</button>
					</form>
					<form style="display: none;" class="dishowform" id="register"
						role="form">
						<div id="1">
							<input style="border-radius: 4px;" type="text"
								class="form-control item" placeholder="名字"
								aria-describedby="sizing-addon2" id="username"> <span
								style="padding-left: 15px;" class="help-block"></span>
						</div>
						<div id="2">
							<input style="border-radius: 4px;" type="text"
								class="form-control item" placeholder="手机号码 "
								aria-describedby="sizing-addon2" id="phonenumber"> <span
								style="padding-left: 15px;" class="help-block"></span>
						</div>
						<div id="3">
							<input type="password" style="border-radius: 4px;"
								class="form-control item" placeholder="密码"
								aria-describedby="sizing-addon2" id="password"> <span
								style="padding-left: 15px;" class="help-block"></span>
						</div>
						<button type="button" class="btn btn-primary item" id="sup">注册</button>
					</form>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-4 col-md-offset-4 center">
				<div>
					</br> <a href="developers_info.html">关于我们</a> <a href="#"
						style="margin-left: 20px;">Github</a>
				</div>
			</div>
		</div>
	</div>
</body>
<script type="text/javascript">
		$(document).on("click",".inactive",function(){
			var active = $(".active");
			var inactive = $(".inactive");
			
			active.removeClass("active");
			active.addClass("inactive");
			
			inactive.removeClass("inactive");
			inactive.addClass("active");
			
			var showform = $(".showform");
			var dishowform = $(".dishowform");
			
			showform.css("display","none");
			showform.removeClass("showform");
			showform.addClass("dishowform");
			
			dishowform.css("display","block");
			dishowform.removeClass("dishowform");
			dishowform.addClass("showform");
		});
		
		 
	</script>
<script type="text/javascript"> 
	    function validate_login() {
	    	var flag = new Boolean(true);
	    	var phone = $("#phone").val();
    		
    		var regphonenumber = /^1[3|4|5|7|8]\d{9}$/;
    		if(!regphonenumber.test(phone)){
    		show_validate_msg("#phone","error","输入正确手机号");
    		$("#pwd").css("margin-top","0px");
    		
    		flag = false;
    		}
    		else{
    			show_validate_msg("#phone","success","");
    			$("#pwd").css("margin-top","20px");
    		};
    		
    		//验证密码
    		var pwd = $("#pwd").val();
    		
    		
    		
    		var regpwd1 = /^[a-zA-Z]\w{5,17}$/;
    		if(!regpwd1.test(pwd)){
    			/*alert ("老哥这个密码不保险啊");
    			return false;*/
    		show_validate_msg("#pwd","error","输入正确密码");
    		$("#sin").css("margin-top","0px");
    		//return false;
    		flag = false;
    		}
    		else{
    			show_validate_msg("#pwd","success","");
    			$("#sin").css("margin-top","20px");
    		};
    		
    	
    		return flag;
    	}
	    	
	    
    	　
    	function validate_register(){
    		//验证姓名
    		
    		var flag = new Boolean(true);
    		var username = $("#username").val();
    		
    		var reguser = /(^[A-Za-z0-9]+$|^[\u4e00-\u9fa5\u3447]{2,6}$)/;
    		if(!reguser.test(username)){
    			/*alert ("换一个哇，老哥，这个不行");
    			return false;*/
    		show_validate_msg("#username","error","输入正确姓名");
    		$("#phonenumber").css("margin-top","0px");
    		//return false;
    		flag = false;
    		
    		}else{
    			show_validate_msg("#username","success","");
    			$("#phonenumber").css("margin-top","20px");
    		};
    		//验证手机号
    		var phonenumber = $("#phonenumber").val();
    		
    		var regphone = /^1[3|4|5|7|8]\d{9}$/;
    		if(!regphone.test(phonenumber)){
    			/*alert ("请输入正确的手机号码");
    			return false;*/
    		show_validate_msg("#phonenumber","error","输入正确手机号");
    		$("#password").css("margin-top","0px");
    		//return false;
    		flag = false;
    		}
    		else{
    			show_validate_msg("#phonenumber","success","");
    			$("#password").css("margin-top","20px");
    		};
    		
    		//验证密码
    		var password = $("#password").val();
    		
    		
    		
    		
    		var regpwd = /^[a-zA-Z]\w{5,17}$/;
    		if(!regpwd.test(password)){
    			/*alert ("老哥这个密码不保险啊");
    			return false;*/
    		show_validate_msg("#password","error","输入正确密码");
    		$("#sup").css("margin-top","0px");
    		//return false;
    		flag = false;
    		}
    		else{
    			show_validate_msg("#password","success","");
    			$("#sup").css("margin-top","20px");
    		};
    		
    	
    		return flag;
    	}
    	   
    		function show_validate_msg(ele,status,msg){
    		$(ele).parent().removeClass("has-success has-error");
    		$(ele).next("span").text("");
    		if("success" == status){
    			$(ele).parent().addClass("has-success");
    			$(ele).next("span").text(msg);
    		}else{
    			if("error" == status){
    			$(ele).parent().addClass("has-error");
    			$(ele).next("span").text(msg);
    		}
    	}
    		
    	};
     
    	$("#sin").click(function(){
    		 if(validate_login()){
			  $.ajax({
                type : "post",
                url : '/blog/sin.do',
                data : '{"phone_num":"'+$("#phone").val()+'","user_pwd" : "'+$("#pwd").val()+'"}',
                //dataType : "json",
                contentType:'application/json;charset=utf-8',  
                success : function(data) {
                   console.log(data);
                   console.log(data.code);
                   if( data.code!='101'){
                	   $('.modal-body p').text(data.msg);
                	   $('#myModal').click();
                   }
                },
                error : function(d) {
                	
                  
                }
               })
		     }
		});

    	
    	
    	$("#sup").click(function(){
    		    if(validate_register()){
    		  	  $.ajax({
    	                type : "post",
    	                url : '/blog/sup.do',
    	                data : '{"phone_num":"'+$("#phonenumber").val()
    	                	+'","user_pwd" : "'+$("#password").val()
    	                	+'","user_name" : "'+$("#username").val()+'"}',
    	                dataType : "json",
    	                contentType:'application/json;charset=utf-8',  
    	                success : function(data) {
    	                	  console.log(data);
    	                      console.log(data.code);
    	                      if( data.code!='101'){
    	                   	   $('.modal-body p').text(data.msg);
    	                   	   $('#myModal').click();
    	                      }
    	                },
    	                error : function(d) {
    	                  
    	                }
    			})
    		    }
    	});
    	</script>
</html>